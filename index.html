<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è‘‰å­èŠ±ç ” Leaf Flower Design | è¨‚å–®ç³»çµ±</title>
    
    <link rel="apple-touch-icon" href="icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="è‘‰å­èŠ±ç ”">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&family=Noto+Sans+TC:wght@300;400&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f0f2f0; padding-bottom: 50px; -webkit-tap-highlight-color: transparent; }
        .serif { font-family: 'Noto Serif TC', serif; }
        .a4-container { width: 210mm; min-height: 297mm; padding: 40px; margin: 20px auto; background: white; box-shadow: 0 10px 30px rgba(0,0,0,0.1); display: flex; flex-direction: column; position: relative; }
        .tag-btn { border: 1px solid #d1d5db; padding: 6px 10px; border-radius: 8px; font-size: 0.75rem; transition: all 0.2s; background: white; cursor: pointer; display: flex; flex-direction: column; align-items: flex-start; line-height: 1.2; min-width: 80px; }
        .tag-btn .lang-extra { color: #059669; font-weight: bold; font-size: 0.65rem; }
        .tag-btn.active { background-color: #065f46 !important; color: white !important; border-color: #065f46; }
        .tag-btn.active .lang-extra { color: #a7f3d0 !important; }
        .input-field { border-bottom: 1px solid #d4d4d8; width: 100%; padding: 8px 0; outline: none; background: transparent; font-size: 1rem; line-height: 1.5; }
        .capture-text { display: none; font-size: 1.1rem; font-weight: 500; color: #1a1a1a; padding: 8px 0; border-bottom: 1px solid transparent; }
        .is-capturing .input-field { display: none; }
        .is-capturing .capture-text { display: block; }
        .is-capturing select { display: none; }
        .lang-label { font-size: 0.75rem; color: #71717a; margin-top: 10px; display: block; font-weight: bold; }
        .extra-lang { color: #059669; }
        .hint-text { font-size: 0.7rem; color: #ea580c; margin-top: 4px; font-weight: 500; }
        @media (max-width: 768px) { .a4-container { width: 98%; padding: 15px; margin: 5px auto; min-height: auto; } }
    </style>
</head>
<body>

    <div class="max-w-5xl mx-auto mb-4 flex flex-wrap gap-4 items-center justify-between bg-white/90 backdrop-blur p-4 rounded-b-2xl shadow-sm sticky top-0 z-50 no-print">
        <div class="flex gap-2 items-center">
            <span class="text-xs font-bold text-emerald-800">èªè¨€ (Add Language):</span>
            <select id="lang-selector" class="border rounded-lg px-2 py-1 text-xs bg-white outline-none">
                <option value="">è«‹é¸æ“‡ (None)</option>
                <option value="jp">æ—¥æœ¬èª (JP)</option>
                <option value="kr">í•œêµ­ì–´ (KR)</option>
                <option value="vn">Tiáº¿ng Viá»‡t (VN)</option>
                <option value="id">Indonesia (ID)</option>
                <option value="th">à¹„à¸—à¸¢ (TH)</option>
                <option value="ph">Tagalog (PH)</option>
            </select>
        </div>
        <button onclick="generateImage()" class="bg-emerald-700 text-white px-6 py-2 rounded-full hover:bg-emerald-800 transition shadow-lg active:scale-95 text-sm font-bold">ç”Ÿæˆè¨‚å–®åœ–ç‰‡</button>
    </div>

    <div id="capture-area" class="a4-container border-t-[12px] border-emerald-800">
        <div class="flex justify-between items-start mb-6">
            <div class="flex items-center gap-4">
                <div class="w-14 h-14 bg-emerald-800 rounded-xl flex items-center justify-center text-white serif text-xl shadow-inner">è‘‰</div>
                <div>
                    <h1 class="text-xl font-bold text-emerald-900 serif leading-none">è‘‰å­èŠ±ç ”</h1>
                    <p class="text-[8px] text-emerald-700 tracking-widest uppercase font-light mt-1">Leaf Flower Design</p>
                </div>
            </div>
            <div class="text-right">
                <p class="text-[10px] text-gray-400 tracking-widest uppercase">Order Receipt</p>
                <p class="text-sm font-mono text-gray-700" id="display-date"></p>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4 text-sm">
            <section class="space-y-3">
                <h2 class="text-emerald-800 font-bold border-b border-emerald-100 pb-1 text-xs uppercase">åŸºæœ¬è³‡è¨Š / INFO</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div class="input-wrapper"><label class="lang-label">å§“å Name <span class="extra-lang" data-key="name"></span></label><input type="text" class="input-field" placeholder="é»æ“Šå¡«å¯«"><div class="capture-text"></div></div>
                    <div class="input-wrapper"><label class="lang-label">æ‰‹æ©Ÿ Phone <span class="extra-lang" data-key="phone"></span></label><input type="tel" class="input-field" placeholder="09xx..."><div class="capture-text"></div></div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="input-wrapper"><label class="lang-label">æ—¥æœŸ Date <span class="extra-lang" data-key="date"></span></label><input type="date" class="input-field"><div class="capture-text"></div></div>
                    <div class="input-wrapper"><label class="lang-label">æ™‚é–“ Time <span class="extra-lang" data-key="time"></span></label><select id="time-select" class="input-field font-mono"></select><div class="capture-text"></div></div>
                </div>
                <div><label class="lang-label">æ˜ŸæœŸ Day <span class="extra-lang" data-key="day_label"></span></label><div class="flex flex-wrap gap-1 mt-1" id="day-tags"></div></div>
            </section>

            <section class="space-y-3">
                <h2 class="text-emerald-800 font-bold border-b border-emerald-100 pb-1 text-xs uppercase">å°è±¡ç›®çš„ / PURPOSE</h2>
                <div><label class="lang-label">æ”¶ç¦®å°è±¡ Recipient <span class="extra-lang" data-key="target_label"></span></label><div class="flex flex-wrap gap-1 mt-1" id="target-tags"></div></div>
                <div><label class="lang-label">é€èŠ±ç›®çš„ Purpose <span class="extra-lang" data-key="purpose_label"></span></label><div class="flex flex-wrap gap-1 mt-1" id="purpose-tags"></div></div>
            </section>

            <section class="md:col-span-2 space-y-3">
                <h2 class="text-emerald-800 font-bold border-b border-emerald-100 pb-1 text-xs uppercase">è¨­è¨ˆç´°ç¯€ / DESIGN</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="lang-label">èŠ±ç¦®é¡å‹ Type <span class="extra-lang" data-key="type_label"></span></label>
                        <div class="flex flex-wrap gap-1 mt-1" id="type-tags"></div>
                        <div class="hint-text mt-2 bg-orange-50 p-2 rounded border border-orange-100">
                            ğŸ’¡ <span>å¦‚æœ‰åƒè€ƒåœ–ç‰‡ï¼Œè«‹ä¸»å‹•å‡ºç¤ºä¾›è€å¸«åƒè€ƒ</span><br>
                            <span class="text-[9px] text-gray-500 italic block">Please show reference photos if available.</span>
                            <span class="extra-lang block text-[9px] italic" data-key="hint_photo"></span>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <div><label class="lang-label">èŠ±è—è‰²ç³» Flower Color <span class="extra-lang" data-key="fcolor_label"></span></label><div class="flex flex-wrap gap-1 mt-1" id="fcolor-tags"></div></div>
                        <div><label class="lang-label">åŒ…è£è‰²ç³» Wrapping Color <span class="extra-lang" data-key="wcolor_label"></span></label><div class="flex flex-wrap gap-1 mt-1" id="wcolor-tags"></div></div>
                    </div>
                </div>
            </section>

            <section class="md:col-span-2 bg-gray-50 p-3 rounded-xl border border-gray-100">
                <h2 class="text-emerald-800 font-bold border-b border-emerald-100 pb-1 text-xs uppercase">ä»˜æ¬¾è³‡è¨Š / PAYMENT</h2>
                <div class="grid grid-cols-3 gap-6">
                    <div class="input-wrapper"><label class="lang-label">ç¸½åƒ¹ Total</label><input type="number" id="price-total" class="input-field font-bold" oninput="calcBalance()"><div class="capture-text font-bold"></div></div>
                    <div class="input-wrapper"><label class="lang-label">è¨‚é‡‘ Deposit</label><input type="number" id="price-deposit" class="input-field text-blue-600" oninput="calcBalance()"><div class="capture-text text-blue-600"></div></div>
                    <div class="input-wrapper"><label class="lang-label text-red-600 font-bold italic">é¤˜é¡ Balance / <span class="extra-lang" data-key="balance"></span></label><input type="text" id="price-balance" class="input-field font-bold text-red-600" readonly><div class="capture-text text-red-600 font-bold"></div></div>
                </div>
                <div class="pt-2 border-t border-gray-200 mt-2">
                    <div class="text-[9px] leading-relaxed text-emerald-800 font-medium">
                        <div>â— æ»¿ $1000 è´ˆèŠ±ç¦®å°ˆç”¨æè¢‹ï¼Œæœªæ»¿è€…åŠ è³¼ $50/å€‹</div>
                        <div class="text-gray-400 italic">Complimentary bag for orders over $1000. Under $1000, $50 each.</div>
                        <div class="extra-lang italic" data-key="hint_bag"></div>
                    </div>
                </div>
            </section>
        </div>

        <div class="mt-4 p-3 bg-emerald-50/30 rounded-xl border border-emerald-100 flex-grow input-wrapper">
            <label class="lang-label font-bold text-emerald-800 mb-1">å‚™è¨» Remarks <span class="extra-lang" data-key="note"></span></label>
            <textarea class="w-full bg-transparent border-none outline-none h-24 resize-none text-sm input-field" placeholder="Input details..."></textarea>
            <div class="capture-text whitespace-pre-wrap"></div>
        </div>
        <footer class="mt-4 text-center border-t border-dashed pt-2"><p class="text-[8px] text-emerald-700/60 serif tracking-[0.3em]">LEAF FLOWER DESIGN Â· è®“æ¤ç‰©èµ°å…¥ä½ çš„ç”Ÿæ´»</p></footer>
    </div>

    <script>
        const config = {
            day: [{zh:'ä¸€',en:'Mon',jp:'æœˆ',kr:'ì›”',vn:'Thá»© 2',id:'Sen',ph:'Lun',th:'à¸ˆà¸±à¸™à¸—à¸£à¹Œ'},{zh:'äºŒ',en:'Tue',jp:'ç«',kr:'í™”',vn:'Thá»© 3',id:'Sel',ph:'Mar',th:'à¸­à¸±à¸‡à¸„à¸²à¸£'},{zh:'ä¸‰',en:'Wed',jp:'æ°´',kr:'ìˆ˜',vn:'Thá»© 4',id:'Rab',ph:'Miy',th:'à¸à¸¸à¸˜'},{zh:'å››',en:'Thu',jp:'æœ¨',kr:'ëª©',vn:'Thá»© 5',id:'Kam',ph:'Huw',th:'à¸à¸¤à¸«à¸±à¸ª'},{zh:'äº”',en:'Fri',jp:'é‡‘',kr:'ê¸ˆ',vn:'Thá»© 6',id:'Jum',ph:'Biy',th:'à¸¨à¸¸à¸à¸£à¹Œ'},{zh:'å…­',en:'Sat',jp:'åœŸ',kr:'í† ',vn:'Thá»© 7',id:'Sab',ph:'Sab',th:'à¹€à¸ªà¸²à¸£à¹Œ'},{zh:'æ—¥',en:'Sun',jp:'æ—¥',kr:'ì¼',vn:'CN',id:'Min',ph:'Lin',th:'à¸­à¸²à¸—à¸´à¸•à¸¢à¹Œ'}],
            target: [{zh:'ç”·ç”Ÿ',en:'Male',jp:'ç”·æ€§',kr:'ë‚¨ì„±',vn:'Nam',id:'Pria',ph:'Lalaki',th:'à¸œà¸¹à¹‰à¸Šà¸²à¸¢'},{zh:'å¥³ç”Ÿ',en:'Female',jp:'å¥³æ€§',kr:'ì—¬ì„±',vn:'Ná»¯',id:'Wanita',ph:'Babae',th:'à¸œà¸¹à¹‰à¸«à¸à¸´à¸‡'},{zh:'å¤§äºº',en:'Adult',jp:'å¤§äºº',kr:'ì„±ì¸',vn:'NgÆ°á»i lá»›n',id:'Dewasa',ph:'Matanda',th:'à¸œà¸¹à¹‰à¹ƒà¸«à¸à¹ˆ'},{zh:'å°å­©',en:'Child',jp:'å­ä¾›',kr:'ì•„ì´',vn:'Tráº» em',id:'Anak',ph:'Bata',th:'à¹€à¸”à¹‡à¸'}],
            purpose: [{zh:'ç”Ÿæ—¥',en:'B-Day',jp:'èª•ç”Ÿæ—¥',kr:'ìƒì¼',vn:'Sinh nháº­t',id:'Ultah',ph:'B-Day',th:'à¸§à¸±à¸™à¹€à¸à¸´à¸”'},{zh:'ç•¢æ¥­',en:'Grad',jp:'å’æ¥­',kr:'ì¡¸ì—…',vn:'Tá»‘t nghiá»‡p',id:'Wisuda',ph:'Grad',th:'à¸£à¸±à¸šà¸›à¸£à¸´à¸à¸à¸²'},{zh:'æ¯è¦ª',en:'Mother',jp:'æ¯ã®æ—¥',kr:'ì–´ë²„ì´ë‚ ',vn:'NgÃ y cá»§a máº¹',id:'Hari Ibu',ph:'Nanay',th:'à¸§à¸±à¸™à¹à¸¡à¹ˆ'},{zh:'çˆ¶è¦ª',en:'Father',jp:'çˆ¶ã®æ—¥',kr:'ìŠ¤ìŠ¹ì˜ë‚ ',vn:'NgÃ y cá»§a cha',id:'Hari Ayah',ph:'Tatay',th:'à¸§à¸±à¸™à¸à¹ˆà¸­'},{zh:'æƒ…äºº',en:'Val',jp:'æ‹äºº',kr:'ë°œë Œíƒ€ì¸',vn:'TÃ¬nh nhÃ¢n',id:'Valentine',ph:'Val',th:'à¸§à¸²à¹€à¸¥à¸™à¹„à¸—à¸™à¹Œ'},{zh:'å…¶ä»–',en:'Other',jp:'ä»–',kr:'ê¸°íƒ€',vn:'KhÃ¡c',id:'Lainnya',ph:'Iba pa',th:'à¸­à¸·à¹ˆà¸™à¹†'}],
            type: [{zh:'é®®èŠ±',en:'Bouquet',jp:'èŠ±æŸ',kr:'ê½ƒë‹¤ë°œ',vn:'Hoa tÆ°Æ¡i',id:'Segar',ph:'Bulaklak',th:'à¸”à¸­à¸à¹„à¸¡à¹‰à¸ªà¸”'},{zh:'ä¹¾ç‡¥',en:'Dried',jp:'ãƒ‰ãƒ©ã‚¤',kr:'ë“œë¼ì´',vn:'Hoa khÃ´',id:'Kering',ph:'Tuyo',th:'à¸”à¸­à¸à¹„à¸¡à¹‰à¹à¸«à¹‰à¸‡'},{zh:'ç›†æ ½',en:'Plant',jp:'é‰¢æ¤ãˆ',kr:'í™”ë¶„',vn:'Cháº­u cÃ¢y',id:'Tanaman',ph:'Halaman',th:'à¸à¸£à¸°à¸–à¸²à¸‡à¸•à¹‰à¸™à¹„à¸¡à¹‰'},{zh:'ç…§ç‰‡',en:'Photo',jp:'å†™çœŸ',kr:'ì‚¬ì§„',vn:'áº¢nh máº«u',id:'Foto',ph:'Litratro',th:'à¸£à¸¹à¸›à¸ à¸²à¸à¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡'}],
            color: [{zh:'ç´…',en:'Red',jp:'èµ¤',kr:'ë¹¨ê°•',vn:'Äá»',id:'Merah',ph:'Pula',th:'à¹à¸”à¸‡'},{zh:'æ©™',en:'Org',jp:'æ©™',kr:'ì£¼í™©',vn:'Cam',id:'Oranye',ph:'Kulay-dalandan',th:'à¸ªà¹‰à¸¡'},{zh:'é»ƒ',en:'Yel',jp:'é»ƒ',kr:'ë…¸ë‘',vn:'VÃ ng',id:'Kuning',ph:'Dilaw',th:'à¹€à¸«à¸¥à¸·à¸­à¸‡'},{zh:'ç¶ ',en:'Grn',jp:'ç¶ ',kr:'ì´ˆë¡',vn:'Xanh lÃ¡',id:'Hijau',ph:'Berde',th:'à¹€à¸‚à¸µà¸¢à¸§'},{zh:'è—',en:'Blu',jp:'é’',kr:'íŒŒë‘',vn:'Xanh dÆ°Æ¡ng',id:'Biru',ph:'Asul',th:'à¸™à¹‰à¸³à¹€à¸‡à¸´à¸™'},{zh:'ç´«',en:'Pur',jp:'ç´«',kr:'ë³´ë¼',vn:'TÃ­m',id:'Ungu',ph:'Lila',th:'à¸¡à¹ˆà¸§à¸‡'},{zh:'ç™½',en:'Wht',jp:'ç™½',kr:'í•˜ì–‘',vn:'Tráº¯ng',id:'Putih',ph:'Puti',th:'à¸‚à¸²à¸§'},{zh:'é»‘',en:'Blk',jp:'é»‘',kr:'ê²€ì •',vn:'Äen',id:'Hitam',ph:'Itim',th:'à¸”à¸³'}]
        };

        const translations = {
            jp: { name: "/ æ°å", phone: "/ é›»è©±", date: "/ æ—¥ä»˜", time: "/ æ™‚é–“", day_label: "/ æ›œæ—¥", target_label: "/ å¯¾è±¡", purpose_label: "/ ç›®çš„", type_label: "/ ç¨®é¡", fcolor_label: "/ èŠ±è‰²", wcolor_label: "/ åŒ…è£…è‰²", note: "/ å‚™è€ƒ", balance: "æ®‹é«˜", hint_photo: "å‚è€ƒç”»åƒãŒã‚ã‚‹å ´åˆã¯ã€æç¤ºã—ã¦ãã ã•ã„ã€‚", hint_bag: "1000å…ƒä»¥ä¸ŠãŠè²·ã„ä¸Šã’ã§å°‚ç”¨ãƒãƒƒã‚°ã‚’ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã€‚" },
            kr: { name: "/ ì´ë¦„", phone: "/ ì „í™”", date: "/ ë‚ ì§œ", time: "/ ì‹œê°„", day_label: "/ ìš”ì¼", target_label: "/ ëŒ€ìƒ", purpose_label: "/ ëª©ì ", type_label: "/ ìœ í˜•", fcolor_label: "/ ê½ƒìƒ‰", wcolor_label: "/ í¬ì¥ìƒ‰", note: "/ ë©”ëª¨", balance: "ì”ì•¡", hint_photo: "ì°¸ê³  ì‚¬ì§„ì´ ìˆìœ¼ë©´ ì„ ìƒë‹˜ê»˜ ë³´ì—¬ì£¼ì„¸ìš”.", hint_bag: "1000ì› ì´ìƒ êµ¬ë§¤ ì‹œ ì „ìš© ì‡¼í•‘ë°± ì¦ì •." },
            vn: { name: "/ Há» tÃªn", phone: "/ SÄT", date: "/ NgÃ y", time: "/ Giá»", day_label: "/ Thá»©", target_label: "/ Äá»‘i tÆ°á»£ng", purpose_label: "/ Má»¥c Ä‘Ã­ch", type_label: "/ Loáº¡i", fcolor_label: "/ MÃ u hoa", wcolor_label: "/ MÃ u giáº¥y", note: "/ Ghi chÃº", balance: "Sá»‘ dÆ°", hint_photo: "Vui lÃ²ng cho giÃ¡o viÃªn xem áº£nh tham kháº£o.", hint_bag: "ÄÆ¡n hÃ ng trÃªn $1000 táº·ng tÃºi Ä‘á»±ng hoa." },
            id: { name: "/ Nama", phone: "/ No HP", date: "/ Tanggal", time: "/ Waktu", day_label: "/ Hari", target_label: "/ Target", purpose_label: "/ Tujuan", type_label: "/ Jenis", fcolor_label: "/ Warna Bunga", wcolor_label: "/ Warna Kertas", note: "/ Catatan", balance: "Sisa", hint_photo: "Mohon tunjukkan foto referensi kepada guru.", hint_bag: "Gratis kantong bunga untuk pesanan di atas $1000." },
            th: { name: "/ à¸Šà¸·à¹ˆà¸­", phone: "/ à¹‚à¸—à¸£", date: "/ à¸§à¸±à¸™à¸—à¸µà¹ˆ", time: "/ à¹€à¸§à¸¥à¸²", day_label: "/ à¸§à¸±à¸™", target_label: "/ à¸œà¸¹à¹‰à¸£à¸±à¸š", purpose_label: "/ à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ", type_label: "/ à¸›à¸£à¸°à¹€à¸ à¸—", fcolor_label: "/ à¸ªà¸µà¸”à¸­à¸à¹„à¸¡à¹‰", wcolor_label: "/ à¸ªà¸µà¸«à¹ˆà¸­", note: "/ à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸", balance: "à¸¢à¸­à¸”à¸„à¸‡à¹€à¸«à¸¥à¸·à¸­", hint_photo: "à¸«à¸²à¸à¸¡à¸µà¸£à¸¹à¸›à¸ à¸²à¸à¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡ à¹‚à¸›à¸£à¸”à¹à¸ªà¸”à¸‡à¹ƒà¸«à¹‰à¸„à¸£à¸¹à¸”à¸¹", hint_bag: "à¸¢à¸­à¸”à¸‹à¸·à¹‰à¸­à¸„à¸£à¸š $1000 à¸Ÿà¸£à¸µà¸–à¸¸à¸‡à¹ƒà¸ªà¹ˆà¸”à¸­à¸à¹„à¸¡à¹‰" },
            ph: { name: "/ Pangalan", phone: "/ No. Telepono", date: "/ Petsa", time: "/ Oras", day_label: "/ Araw", target_label: "/ Tatanggap", purpose_label: "/ Layunin", type_label: "/ Uri", fcolor_label: "/ Kulay ng bulaklak", wcolor_label: "/ Kulay ng balot", note: "/ Tandaan", balance: "Balanse", hint_photo: "Pakipakita ang mga reference na larawan sa guro.", hint_bag: "Libreng bag para sa higit sa $1000. Kapag kulang, $50 bawat isa." }
        };

        function initTags(lang = "") { renderSection('day-tags',config.day,lang,'day'); renderSection('target-tags',config.target,lang,'target'); renderSection('purpose-tags',config.purpose,lang,'purpose'); renderSection('type-tags',config.type,lang,'type'); renderSection('fcolor-tags',config.color,lang,'fcolor'); renderSection('wcolor-tags',config.color,lang,'wcolor'); }
        function renderSection(id,data,lang,cat) {
            const container = document.getElementById(id); const activeValues = Array.from(container.querySelectorAll('.active')).map(b => b.getAttribute('data-zh')); container.innerHTML = '';
            data.forEach(item => {
                const btn = document.createElement('button'); btn.className = 'tag-btn' + (activeValues.includes(item.zh) ? ' active' : ''); btn.setAttribute('data-zh', item.zh);
                btn.onclick = () => { if (cat === 'day' || cat === 'type') { container.querySelectorAll('.tag-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); } else { btn.classList.toggle('active'); } };
                let html = `<span>${item.zh}/${item.en}</span>`; if (lang && item[lang]) html += `<span class="lang-extra">${item[lang]}</span>`;
                btn.innerHTML = html; container.appendChild(btn);
            });
        }
        document.getElementById('lang-selector').addEventListener('change', (e) => { const lang = e.target.value; initTags(lang); document.querySelectorAll('.extra-lang').forEach(el => { const key = el.getAttribute('data-key'); el.innerText = (lang && translations[lang][key]) ? translations[lang][key] : ""; }); });
        const timeSelect = document.getElementById('time-select');
        for (let h = 8; h <= 20; h++) { ['00', '30'].forEach(m => { if (h === 20 && m === '30') return; const t = `${h.toString().padStart(2, '0')}:${m}`; timeSelect.add(new Option(t, t)); }); }
        function calcBalance() { const total = parseFloat(document.getElementById('price-total').value) || 0; const deposit = parseFloat(document.getElementById('price-deposit').value) || 0; document.getElementById('price-balance').value = `$ ${total - deposit}`; }
        async function generateImage() {
            const area = document.getElementById('capture-area'); const btn = event.target; btn.innerText = "Processing..."; btn.disabled = true;
            document.querySelectorAll('.input-wrapper').forEach(wrapper => { const input = wrapper.querySelector('.input-field'); const textDiv = wrapper.querySelector('.capture-text'); if (input && textDiv) { textDiv.innerText = input.value || "â€”"; } });
            area.classList.add('is-capturing');
            try { const canvas = await html2canvas(area, { scale: 3, backgroundColor: "#ffffff", useCORS: true }); const link = document.createElement('a'); link.download = `LeafFlower-${Date.now()}.png`; link.href = canvas.toDataURL("image/png"); link.click(); } catch(e) { alert("Error!"); } finally { area.classList.remove('is-capturing'); btn.innerText = "ç”Ÿæˆåœ–ç‰‡"; btn.disabled = false; }
        }
        document.getElementById('display-date').innerText = new Date().toLocaleDateString();
        initTags();
    </script>
</body>
</html>